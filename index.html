<!-- Room Scout, something I threw together to make checking room status a little easier. Looks like trash atm
but hoping to add some more functionality to it eventually-->
<!DOCTYPE html>
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Room Scout</title>

    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.9.0/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://kit.fontawesome.com/94cc33fdff.js"
      crossorigin="anonymous"
    ></script>
    <script> 

    function fetch_room_status(bldg, room) {

        // Remove the error if it exists
        if (document.getElementById('room-error')) {
            document.getElementById('room-error').remove();
        }

        if ( validate_location(bldg, room) ) {

        //   construct the url to send the user to
          console.log(
            `http://splus.uq.edu.au/Signage/Reports/BootstrapList.aspx?objects=${bldg}-${room}&template=bootstrap_location_up_next&searchbydates=1&start=0&end=1018`
          );
      
          
          if (document.getElementById('room_result')) {
            document.getElementById('room_result').remove()
          }

          let iframe = document.createElement('iframe');
          iframe.id = "room_result";
          iframe.title = "room_result";
          iframe.className = "w-full h-screen py-10";
          iframe.src = `http://splus.uq.edu.au/Signage/Reports/BootstrapList.aspx?objects=${bldg}-${room}&template=bootstrap_location_up_next&searchbydates=1&start=0&end=1018`;

          document.getElementById('main').insertAdjacentElement('beforeend', iframe);

          iframe.onload = function() {
              document.getElementById('room_result').scrollIntoView({behavior: "smooth"});
          }
          
          return true;

        } else {
          // Code to execute if bldg and room are not valid
          console.log("Alert being generated");

          const warning = `<div role="alert" id="room-error" class="alert alert-error ">
                    
                    <span>Invalid building or room number - check your input</span>
                </div>`;
            document.getElementById('room_form').insertAdjacentHTML('afterbegin', warning);
            return false;
        }
      }
      
      function single_room_multi_day(bldg, room, from, to) {
        let date_from = new Date(from);
        let date_to = new Date(to);  
        if (!validate_location(bldg, room)) {
            create_error_message("Invalid building or room number - check your input");
            return false;
          } else if (!date_from < date_to) {
            create_error_message("single-room-multi", "Invalid date range")
            return false;
          } else {
            open(
            `http://splus.uq.edu.au/TimetableYear/Reports/CoreCalendar.aspx?template=location_grid_bigscreen&objects=${bldg}-${room}&days=${date_from.getDay()}-${date_to.getDay()}&weeks=t&periods=5-33`,
            "_blank"
          );
            return true;
          }
      }

      function multi_room_multi_day(rooms, from, to) {

      }

      function create_error_message(element, message) {
        const error = `<div role="alert" class="alert alert-error ">
                    
                    <span>${message}</span>
                </div>`;
        document.getElementById(element).insertAdjacentHTML('afterbegin', error);
      }

      function validate_location(bldg, room) {
        const bldg_re = /(?:^[0-9]{2,2}[A-Z]{0,1}$)/;
        const room_re = /(?:^[A-Z]{0,1}[0-9]{3,3}$)/;

        if ( bldg_re.test(bldg) && room_re.test(room) ) {
          return true;
        }
        return false;

      }

    </script>
</head>
<main class="h-full py-20">
  <header class="fixed inset-x-0 top-0 z-40 sticky scroll-smooth">
    <div class="navbar bg-slate-700 text-white">
        <div class="flex-1">
          <p class="font-bold text-2xl px-5">Room Scout</p>
        </div>
        <div class="dropdown dropdown-end">
            <div tabindex="0" role="button" class="btn btn-ghost btn-circle">
              <div class="rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg>
              </div>
            </div>
            <ul tabindex="0" class="mt-3 z-[1] p-2 shadow menu menu-sm dropdown-content bg-slate-700 rounded-box w-52">
              <li><a href="https://maps.uq.edu.au/?campusId=406&zoom=17.446346972410538&lat=-27.497653891682695&lng=153.01351593000186&zLevel=1" target="_blank">UQ Maps</a></li>
              <li>
                <a href="https://campuses.uq.edu.au/information-and-services/maps/floor-plans" target="_blank">Floor plans</a>
              </li>
              <li><a href="https://uqbookit.uq.edu.au/" target="_blank">UQ Book It</a></li>
            </ul>
          </div>
      </div>
    </header>
        <section id="main" class="flex flex-col justify-center m-auto h-full w-1/2">

        <div class="hero-content text-center self-center"></div>
          <div class="collapse collapse-arrow bg-slate-200 my-2">
            <input type="radio" name="my-accordion-2" checked="checked" /> 
            <div class="collapse-title text-xl font-medium">
              View current room status
            </div>
            <div class="collapse-content"> 
              <div class="hero-content text-center self-center py-20">
                <div class="max-w-md">
                  <h1 class="text-5xl font-bold">View UQ room status</h1>
                  <p class="py-6">Enter the UQ building and room number (including teaching rooms).</p>
                  
                  <form id="room_form" class="flex flex-col gap-10 justify-middle" onsubmit="event.preventDefault(); let result0 = fetch_room_status(this.building.value, this.room.value);">
                      <div>
                          <input type="text" name="building" required placeholder="Building number" class="input input-bordered w-full max-w-xs" />
                      </div>
                      <div>
                          <input type="text" name="room" required placeholder="Room number" class="input input-bordered w-full max-w-xs" />
                      </div>
      
                          <button type="submit" class="btn btn-outline w-full max-w-xs mx-auto">Is this room booked?</button>
                      </div>
                  </form>   
                </div>
              </div>
            </div>
          </div>
          <div class="collapse collapse-arrow bg-slate-200 my-2">
            <input type="radio" name="my-accordion-2" /> 
            <div class="collapse-title text-xl font-medium">
              Single room multi-day schedule
            </div>
            <div class="collapse-content"> 
              <!-- <div class="hero-content text-center self-center py-20">
                <div class="max-w-md">
                  <h1 class="text-5xl font-bold">View Single Room Schedule</h1>
                  <p class="py-6">Fetch the schedule for a room over a date range.</p> -->
                  <p>Coming soon</p>
                     
                <!-- </div> -->
            </div>
          </div>
          <div class="collapse collapse-arrow bg-slate-200 my-2">
            <input type="radio" name="my-accordion-2" /> 
            <div class="collapse-title text-xl font-medium">
              Multi-room, multi-day schedule
            </div>
            <div class="collapse-content"> 
              <!-- <div class="hero-content text-center self-center py-20">
                <div class="max-w-md">
                  <h1 class="text-5xl font-bold">View UQ room status</h1>
                  <p class="py-6">Fetch the schedule for multiple rooms over a date ranges.</p> -->
              <p>Coming soon</p>
            <!-- </div> -->
          </div>
          </div>
        </div>
    </section>
</main>

<footer class="footer footer-center p-4 bg-slate-700 text-white text-base-content inset-x-0 bottom-0">

    <aside>
      <p>Copyright Â© 2024 - <a href="https://github.com/The-AhmadAA/Room-Scout" target="_blank">The-AhmadAA & edwardguil</a></p>
    </aside>
  </footer>
</html>